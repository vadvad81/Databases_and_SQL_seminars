/*Вам необходимо получить заказы, которые сделаны в течении 35 дней до даты 2023-10-10 (то есть с 5 сентября до 10 октября включительно).
В Mssql вы бы использовали функцию DATEDIFF, для определения переменных для даты и диапазона.
Отсортируйте по дате заказа.
Используйте таблицу gb_shop.Orders.

Но в этой системе мы напишем запрос на PostgreSQL.
Разница между запросами на PostgreSQL и MSSQL заключается в использовании разных функций и операторов для работы с датами.

Давайте разберем каждую часть запроса для MSSQL:

DATEDIFF(day, orderdate, '2023-10-10'): Эта функция вычисляет разницу между двумя датами в указанных единицах измерения (в данном случае, в днях). Она отличается от оператора BETWEEN в том, что она возвращает разницу между двумя датами, а не фактические даты в заданном диапазоне.

BETWEEN 0 AND 35: Это оператор BETWEEN, который используется для проверки, находится ли значение (в данном случае, разница в днях) между указанными значениями (0 и 35).

Теперь давайте перепишем этот запрос для PostgreSQL, используя соответствующие функции:

CAST(orderdate AS date): Функция CAST используется для преобразования значения одного типа данных в другой. В данном случае, она преобразует значение столбца orderdate, которое, вероятно, хранится как строка или в другом формате, в тип данных date.
Пример: CAST('2023-10-10' AS date) преобразует строку '2023-10-10' в тип данных date.

BETWEEN: Оператор BETWEEN используется для проверки, находится ли значение в заданном диапазоне. Он возвращает TRUE, если значение находится в диапазоне, и FALSE в противном случае.
Пример: SELECT * FROM table WHERE column BETWEEN 10 AND 20.

INTERVAL: Оператор INTERVAL используется для добавления или вычитания интервала времени из даты или времени. Он позволяет добавлять или вычитать дни, часы, минуты и т. д.
Пример: DATE '2023-10-10' - INTERVAL '35 days' вычитает 35 дней из даты 2023-10-10.

Для того, чтобы решить задачу:

Преобразуйте orderdate к типу date с помощью CAST.
Затем используйте BETWEEN для проверки, находится ли преобразованная дата в указанном диапазоне.
Также используйте INTERVAL для вычитания 35 дней из даты '2023-10-10'.
Результаты запроса упорядочьте по дате заказа.*/
-- Вы работаете с PostgreSQL
-- Введите свой код ниже
SELECT 
  * 
FROM 
  gb_shop.Orders 
WHERE 
  CAST(orderdate AS date) BETWEEN CAST('2023-10-10' AS date) - INTERVAL '35 days' 
  AND CAST('2023-10-10' AS date) 
ORDER BY 
  orderdate;
